# 设计原则
> 实践是最重要的

## 前置知识 - 设计模式和原则

设计原则并不是独立出来的。

一个模式也不是只有一种设计原则。

好的设计模式可能是多个设计原则的综合。

## 单一原则(SRP)

一个对象方法只负责一件事情。

* 就像是添加图片节点和图片预加载和懒加载是两件事情。
* 构成对象和将对象封装为单例是两件事情，不需要在构建对象的时候，特意写成单例

也就是能够封装的方法，就封装的优雅一些。是否封装的原则在于：

**如果两个属性(或者方法对象)是同步的变化发生的话，就没有必要封装。**

### 总结

其实这是两面性的概念，因为如果**不封装，减少了扩展性，但是使用会优雅舒服一点。**

## 最少知识原则

对象和对象之间减少耦合。

**如何判断对象和对象之间是否耦合严重**，就是当一个对象变化的时候，另外的对象是否联动着变化。

* 为了体现这个原则，往往会引入第三方进行统一管理
* 在不那么复杂的情况下，也会使用闭包的原则(**函数变量**)

这一点对我来说非常重要，因为是我比较难以把握的一点。

## 开发封闭原则

不改变原有代码，只扩展原有代码。

* 装饰模式是很好的例子 - 不改变，只扩展
* 回调函数 - 不改变原有代码`API`，使用回调扩展

进一步，分析**不改变原有代码，只扩展原有代码**的理由是什么？

1. 原有代码可能不满足要求，需要扩展功能
2. 源代码维护扩展困难

**注意：源代码只是举例说明。有可能指的是某部分数据。**

也就是说**源代码或者数据**处在变化状态，而我们需要这部分数据。依照开放-封闭原则：

1. 代码变化 - 封装变化的这部分，不改变它，添加新的代码段成为一个新的函数。就像是**装饰模式**那样(其他模式其实也体现了这个原则)。
    * 例如**代理模式**，封装对象方法，代理则起到了扩展作用。
2. 数据变化 - 封装数据，监听数据变化。就像是**发布订阅模式**

## 面向接口原则

API!是外部调用对象的方法。

在所有设计模式中都有体现，要实现某个具体功能，就要调用某个对象暴露在外面的方法(`obj.fire()`)，这就是接口。

## 代码重构

个人认为，这个概念包含很多。总有一些小细节可以在平时注意：

1. 提炼代码为函数 - 为了更好的修改
2. 重复代码段为函数 - 为了更好的复用，注意和第一点的区别

只要代码写得多，这两点平时一定是非常注意的。还有一些我平时没有注意到的：

1. 条件分支为代码 - 指的是(`if (code)`指的是`code`那部分)
2. 参数过多时候，用对象代替(类似`json`那种格式)
3. 链式调用 - `promise`或者是`return this`都能够实现链式调用
4. 分解大型类 - 如果一个类中有一个函数体量很大，推荐改进为类。





