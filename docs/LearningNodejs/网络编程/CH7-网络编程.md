# 网络编程
> 原生，没有用框架

<!-- TOC -->

- [1. 网络编程](#1-网络编程)
  - [1.1. 速写](#11-速写)
  - [1.2. TCP](#12-tcp)
    - [1.2.1. 特点](#121-特点)
  - [1.3. HTTP](#13-http)
  - [1.4. 网络安全](#14-网络安全)
    - [1.4.1. SSL](#141-ssl)
      - [1.4.1.1. 攻击](#1411-攻击)
    - [1.4.2. CA](#142-ca)

<!-- /TOC -->

## 1.1. 速写

* tcp - net模块
* udp - dgram
* http - http
* websocket - 文中说的不是很清楚，可能局限于但是还不是发展的很好

都可以实现即是客户端又是服务器。但是前三个要想实现，一般需要开启两个脚本文件，对应服务器A和客户端A。

如果想要在同一个脚本文件中，那么其实对应的服务器A与客户端B(与服务器B对应)

但是Websocket可以在 **同一个脚本文件，实现服务器A和客户端A**

## 1.2. TCP

实现上和`UDP`有区别。**事件监听函数**需要在`createServer`里面。

`telnet 地址`实现`tcp`请求。

### 1.2.1. 特点

* socket.setNoDelay(true)设置之后可以发送比较小的的数据，因为小的数据，服务端处理方式是等到一定量发送。

## 1.3. HTTP

`curl -v 地址`模仿客户端http请求。

以TCP为基础建立的HTTP链接。**文中提到TCP对于每个链接都要建立线程，而HTTP建立连接之后，以每个请求为单位，不需要建立线程。**可以理解为是`TCP`设置`keepalive`时候的状态。

客户端发送较大数据的时候，会告知服务器。服务器通过之后才会进行传输。

注意，文中说到的客户端，服务端事件是针对的有`createServer`创建的`http`实体。不是指的是`req`事件。

## 1.4. 网络安全

### 1.4.1. SSL

设计思想在于，数据通过公钥加密，只能够通过私钥解密。

客户端发送数据使用服务器公钥，服务器接受之后可以使用自己的私钥解密。

服务器发送对应的是使用客户端私钥。

所以在第一次建立连接之后。会交换两者公钥。

#### 1.4.1.1. 攻击

在客户端和服务器之间，加入一个第三方。对客户端伪装服务器，对服务器伪装客户端。会有网络安全问题。

### 1.4.2. CA

为了解决上面问题而存在的。第三方认证。

首先要了解 **基本概念：**

* CA证书
* 服务器证书 - 带有CA签名的证书，所以客户端可以通过CA来验证服务器证书

CA证书一般存在浏览器或者硬件上，在连接的时候，请求服务器证书，然后通过本地CA证书验证。

还有一种情况是小服务器，没办法使用正规CA证书，只要自己生成CA证书，然后在连接的时候，请求服务器证书 **以及CA证书**，然后通过CA证书验证。



