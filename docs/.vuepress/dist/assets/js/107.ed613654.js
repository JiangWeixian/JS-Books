(window.webpackJsonp=window.webpackJsonp||[]).push([[107],{185:function(e,t,v){"use strict";v.r(t);var _=v(0),o=Object(_.a)({},function(){this.$createElement;this._self._c;return this._m(0)},[function(){var e=this,t=e.$createElement,v=e._self._c||t;return v("div",{staticClass:"content"},[v("h1",{attrs:{id:"react%E6%BA%90%E7%A0%81"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#react%E6%BA%90%E7%A0%81","aria-hidden":"true"}},[e._v("#")]),e._v(" React源码")]),e._v(" "),v("blockquote",[v("p",[e._v("生命周期；以及Diff算法&VD分析；"),v("strong",[e._v("Diff算法")])])]),e._v(" "),v("h2",{attrs:{id:"%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F","aria-hidden":"true"}},[e._v("#")]),e._v(" "),v("strong",[e._v("生命周期")])]),e._v(" "),v("p",[v("img",{attrs:{src:"https://raw.githubusercontent.com/JiangWeixian/JS-Books/DeepInReact/%E6%B7%B1%E5%85%A5%E5%AD%A6%E4%B9%A0React%E6%8A%80%E6%9C%AF%E6%A0%88/CH3-React%E6%BA%90%E7%A0%81/img/React%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F.png",alt:"生命周期"}})]),e._v(" "),v("p",[e._v("可以将生命周期分为两个阶段，分别是"),v("code",[e._v("mount")]),e._v("以及"),v("code",[e._v("re-render")]),e._v("阶段。")]),e._v(" "),v("ol",[v("li",[v("code",[e._v("mount")]),e._v(" - 只会在第一次渲染的时候执行一次")]),e._v(" "),v("li",[v("code",[e._v("re-render")]),e._v(" - 会因为"),v("code",[e._v("state or props")]),e._v("更新执行多次")])]),e._v(" "),v("p",[e._v("最后一个阶段是"),v("code",[e._v("unmounting")]),e._v("阶段。")]),e._v(" "),v("blockquote",[v("p",[e._v("要注意，这里的"),v("code",[e._v("mount rerender unmount")]),e._v("阶段意味着很多钩子函数的出发")])]),e._v(" "),v("p",[v("strong",[e._v("注意：")]),e._v(" 图中"),v("code",[e._v("this.setState")]),e._v("被划掉意味着最好不要在这里调用"),v("code",[e._v("setstate")]),e._v("。那么其实只有"),v("strong",[e._v("willmount and receiveprops")]),e._v("钩子函数最好使用"),v("code",[e._v("setstate")]),e._v("。")]),e._v(" "),v("blockquote",[v("p",[e._v("个人理解如果你在"),v("code",[e._v("didmount")]),e._v("调用"),v("code",[e._v("setstate")]),e._v("会触发"),v("code",[e._v("rerender")]),e._v("但是不会循环。因为属于"),v("code",[e._v("mount")]),e._v("阶段的钩子函数只会调用一次。如果你"),v("code",[e._v("setstate")]),e._v("，那么接下来的"),v("code",[e._v("rerender")]),e._v("应该就是"),v("code",[e._v("rerender")]),e._v("阶段的事情了。")])]),e._v(" "),v("blockquote",[v("p",[e._v("不过如果你在"),v("code",[e._v("rerender")]),e._v("阶段的钩子函数里面调用"),v("code",[e._v("setstate")]),e._v("(除了"),v("code",[e._v("receiveprops")]),e._v("函数)，那么可能会可能会导致循环消耗内存。")])]),e._v(" "),v("p",[v("strong",[e._v("在其余钩子函数里面调用"),v("code",[e._v("setstate")]),e._v("可能会引起循环的更新。")]),e._v(" 原因是因为"),v("code",[e._v("willmount receiveprops")]),e._v("两个钩子函数的调用"),v("code",[e._v("setstate")]),e._v("会合并"),v("code",[e._v("state")]),e._v("。")]),e._v(" "),v("h2",{attrs:{id:"setstate"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#setstate","aria-hidden":"true"}},[e._v("#")]),e._v(" setstate")]),e._v(" "),v("ul",[v("li",[e._v("在"),v("code",[e._v("mount")]),e._v("阶段调用的"),v("code",[e._v("setstate")]),e._v("会合并到一处进行更新。除非这个"),v("code",[e._v("setstate")]),e._v("是异步的方式。也就是非异步和异步是两个"),v("code",[e._v("setstate")]),e._v("的调用栈。")])]),e._v(" "),v("blockquote",[v("p",[e._v("可以理解为"),v("code",[e._v("rerender")]),e._v("阶段的"),v("code",[e._v("setstate")]),e._v("是及时的。然而"),v("code",[e._v("mount")]),e._v("是"),v("code",[e._v("batch")]),e._v("合并的。而"),v("code",[e._v("mount")]),e._v("得异步则进入了"),v("code",[e._v("rerender")]),e._v("阶段吗？")])]),e._v(" "),v("h2",{attrs:{id:"diff"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#diff","aria-hidden":"true"}},[e._v("#")]),e._v(" diff")]),e._v(" "),v("p",[e._v("原则")]),e._v(" "),v("ul",[v("li",[e._v("不同组件只会删除和创建")]),e._v(" "),v("li",[e._v("同一层级的组件会进行diff算法")]),e._v(" "),v("li",[e._v("跨层级的被"),v("code",[e._v("react")]),e._v("的忽略了，因为会比较少")])]),e._v(" "),v("p",[e._v("特点：")]),e._v(" "),v("ul",[v("li",[e._v("好像之后移动操作，没有前移操作\n"),v("blockquote",[v("p",[e._v("好像的确是这样，对于同一层级")])])])])])}],!1,null,null,null);t.default=o.exports}}]);