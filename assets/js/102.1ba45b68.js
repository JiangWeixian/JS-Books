(window.webpackJsonp=window.webpackJsonp||[]).push([[102],{191:function(t,e,s){"use strict";s.r(e);var _=s(0),i=Object(_.a)({},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"content"},[t._m(0),t._v(" "),t._m(1),t._v(" "),t._m(2),t._v(" "),t._m(3),t._v(" "),s("p",[t._v("原生Nodejs就带有很多解析字符串之类的方法和函数。")]),t._v(" "),t._m(4),t._v(" "),s("p",[t._v("关于"),s("a",{attrs:{href:"https://github.com/JiangWeixian/JS-Books/tree/master/JS%E9%AB%98%E7%BA%A7%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1/CH22-%E7%A6%BB%E7%BA%BF%E5%BA%94%E7%94%A8%E5%92%8C%E5%AE%A2%E6%88%B7%E7%AB%AF%E7%BC%93%E5%AD%98",target:"_blank",rel:"noopener noreferrer"}},[t._v("cookie"),s("OutboundLink")],1),t._v("介绍，在JS高级程序设计已经解释过了。")]),t._v(" "),t._m(5),t._v(" "),t._m(6),t._v(" "),t._m(7),t._v(" "),t._m(8),t._v(" "),s("p",[t._v("cookie和session成对出现。")]),t._v(" "),t._m(9),t._v(" "),s("p",[t._v("设置方法如下：")]),t._v(" "),t._m(10),t._v(" "),t._m(11),t._v(" "),t._m(12),t._v(" "),t._m(13),t._v(" "),t._m(14),t._v(" "),t._m(15),t._v(" "),t._m(16),t._v(" "),s("p",[t._v("具体可见"),s("a",{attrs:{href:"https://github.com/JiangWeixian/JS-Tips/blob/master/%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80/xss%2Bcsrf.md",target:"_blank",rel:"noopener noreferrer"}},[t._v("xss-csrf"),s("OutboundLink")],1),t._v("分析。")]),t._v(" "),t._m(17),t._v(" "),t._m(18),t._v(" "),t._m(19),t._v(" "),t._m(20),t._v(" "),t._m(21),t._v(" "),t._m(22),t._v(" "),t._m(23),t._v(" "),t._m(24),t._v(" "),t._m(25),t._v(" "),t._m(26),t._v(" "),t._m(27),t._v(" "),t._m(28),t._v(" "),t._m(29),t._v(" "),s("p",[t._v("关于这部分，我之前总结过"),s("a",{attrs:{href:"https://github.com/JiangWeixian/JS-Tips/blob/master/%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80/HTTP-%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96.md",target:"_blank",rel:"noopener noreferrer"}},[t._v("一篇文章"),s("OutboundLink")],1),t._v(" - 前三个客户端/服务器都能够设置，后面两个服务器设置，然后客户端再下一次请求的时候发送。")]),t._v(" "),t._m(30),t._v(" "),t._m(31),t._v(" "),t._m(32),t._v(" "),t._m(33),t._v(" "),t._m(34),t._v(" "),s("p",[t._v("中间件是匹配所有路由的方法，用来处理数据。")]),t._v(" "),s("p",[t._v("看完只有一个感觉，你还是使用路由吧。")]),t._v(" "),t._m(35),t._v(" "),t._m(36),t._v(" "),t._m(37),t._v(" "),t._m(38),t._v(" "),t._m(39),t._v(" "),t._m(40),t._v(" "),t._m(41),t._v(" "),t._m(42)])},[function(){var t=this.$createElement,e=this._self._c||t;return e("h1",{attrs:{id:"_1-构建web应用"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-构建web应用","aria-hidden":"true"}},[this._v("#")]),this._v(" 1. 构建Web应用")])},function(){var t=this.$createElement,e=this._self._c||t;return e("blockquote",[e("p",[this._v("Web需要的基本知识")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ul",[s("li",[s("a",{attrs:{href:"#1-%E6%9E%84%E5%BB%BAweb%E5%BA%94%E7%94%A8"}},[t._v("1. 构建Web应用")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"#11-%E5%8E%9F%E7%94%9F%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86"}},[t._v("1.1. 原生基本知识")])]),t._v(" "),s("li",[s("a",{attrs:{href:"#12-cookie"}},[t._v("1.2. cookie")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"#121-%E6%80%A7%E8%83%BD"}},[t._v("1.2.1. 性能")])])])]),t._v(" "),s("li",[s("a",{attrs:{href:"#13-session"}},[t._v("1.3. session")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"#131-%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%9F%A5%E8%AF%A2"}},[t._v("1.3.1. 字符串查询")])]),t._v(" "),s("li",[s("a",{attrs:{href:"#132-%E7%BC%93%E5%AD%98%E9%97%AE%E9%A2%98"}},[t._v("1.3.2. 缓存问题")])])])]),t._v(" "),s("li",[s("a",{attrs:{href:"#14-%E5%AE%89%E5%85%A8"}},[t._v("1.4. 安全")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"#141-xss"}},[t._v("1.4.1. XSS")])]),t._v(" "),s("li",[s("a",{attrs:{href:"#142-csrf"}},[t._v("1.4.2. csrf")])])])]),t._v(" "),s("li",[s("a",{attrs:{href:"#15-%E6%95%B0%E6%8D%AE%E4%B8%8A%E4%BC%A0"}},[t._v("1.5. 数据上传")])]),t._v(" "),s("li",[s("a",{attrs:{href:"#16-%E6%80%A7%E8%83%BD"}},[t._v("1.6. 性能")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"#161-%E5%AF%B9%E4%BA%8E%E6%95%B0%E6%8D%AE%E4%B8%8A%E4%BC%A0"}},[t._v("1.6.1. 对于数据上传")])])])]),t._v(" "),s("li",[s("a",{attrs:{href:"#17-%E8%B7%AF%E7%94%B1%E5%92%8C%E4%B8%AD%E9%97%B4%E4%BB%B6"}},[t._v("1.7. 路由和中间件")])]),t._v(" "),s("li",[s("a",{attrs:{href:"#18-%E9%A1%B5%E9%9D%A2%E6%B8%B2%E6%9F%93---%E4%B8%AA%E4%BA%BA%E8%A7%89%E5%BE%97%E5%BE%88%E9%87%8D%E8%A6%81"}},[t._v("1.8. 页面渲染 - 个人觉得很重要")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"#181-%E4%B8%8B%E8%BD%BD"}},[t._v("1.8.1. 下载")])])])]),t._v(" "),s("li",[s("a",{attrs:{href:"#19-ssr"}},[t._v("1.9. SSR")])])])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"_1-1-原生基本知识"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-原生基本知识","aria-hidden":"true"}},[this._v("#")]),this._v(" 1.1. 原生基本知识")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"_1-2-cookie"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-cookie","aria-hidden":"true"}},[this._v("#")]),this._v(" 1.2. cookie")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ul",[s("li",[t._v("服务器通过"),s("code",[t._v("set-cookie")]),t._v("来设置客户端"),s("code",[t._v("cookie")]),t._v("。但是 "),s("strong",[t._v("客户端可以供过"),s("code",[t._v("document.cookie")]),t._v("来设置，最好通过设置"),s("code",[t._v("httponly")]),t._v("来限制"),s("code",[t._v("document.cookie")]),t._v("无法使用")]),t._v("。客户端是通过"),s("code",[t._v("secure")]),t._v("的"),s("code",[t._v("cookie")]),t._v("字段。")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"_1-2-1-性能"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-1-性能","aria-hidden":"true"}},[this._v("#")]),this._v(" 1.2.1. 性能")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ul",[s("li",[t._v("cookie不要太大")]),t._v(" "),s("li",[t._v("httponly")]),t._v(" "),s("li",[t._v("不同域名设置不同"),s("code",[t._v("cookie")]),t._v("，类似只设置了"),s("code",[t._v("baidu.com")]),t._v("下面的"),s("code",[t._v("cookie")]),t._v("那么所有"),s("code",[t._v("baidu.com")]),t._v("下面的"),s("code",[t._v("path")]),t._v("都会发送。")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"_1-3-session"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-session","aria-hidden":"true"}},[this._v("#")]),this._v(" 1.3. session")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("p",[t._v("文中一般设置在"),s("code",[t._v("req.session")]),t._v("设置或者修改，借助"),s("code",[t._v("req")]),t._v("全局性，然后通过获取"),s("code",[t._v("req.session")]),t._v("(已经重新设置或修改过了)然后设置到"),s("code",[t._v("res.cookie")]),t._v("中。")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("img",{attrs:{src:"https://raw.githubusercontent.com/JiangWeixian/JS-Books/master/%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BA%E5%AD%A6%E4%B9%A0Nodejs/CH8-%E6%9E%84%E5%BB%BA%E7%BD%91%E7%BB%9C%E5%BA%94%E7%94%A8/img/%E8%AE%BE%E7%BD%AEcookie%E4%B8%8A%E7%9A%84sessionid.PNG",alt:"sessionincookie"}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"_1-3-1-字符串查询"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-1-字符串查询","aria-hidden":"true"}},[this._v("#")]),this._v(" 1.3.1. 字符串查询")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("就是url地址上查询方式。"),e("strong",[this._v("将sessionid放到地址上。")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("文中提到一个重定向方法，就是如果url上没有sessionid，那么就设置重定向，关键在于"),e("code",[this._v("res")]),this._v("中"),e("code",[this._v("location")]),this._v("的值，以及302状态码字。服务器会重定向到"),e("code",[this._v("location")]),this._v("上面。")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"_1-3-2-缓存问题"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-2-缓存问题","aria-hidden":"true"}},[this._v("#")]),this._v(" 1.3.2. 缓存问题")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("session一般存储在"),e("code",[this._v("redis")]),this._v("上面，一般和"),e("code",[this._v("session")]),this._v("的存储服务保持很长的连接。减少网络消耗。因为网络消耗的事件是大于硬盘的。")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"_1-4-安全"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-4-安全","aria-hidden":"true"}},[this._v("#")]),this._v(" 1.4. 安全")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"_1-4-1-xss"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-4-1-xss","aria-hidden":"true"}},[this._v("#")]),this._v(" 1.4.1. XSS")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("脚本攻击，前端解析字符串之后，直接"),e("code",[this._v("innerHTML=一些数据")]),this._v("。如果这些数据带有"),e("code",[this._v("script")]),this._v("脚本，就会被解惑"),e("code",[this._v("cookie")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"_1-4-2-csrf"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-4-2-csrf","aria-hidden":"true"}},[this._v("#")]),this._v(" 1.4.2. csrf")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("strong",[this._v("不和xss攻击一起考虑")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("p",[t._v("向同一个域名发送数据会发送"),s("code",[t._v("cookie")]),t._v("。复制一份表单到新的页面，表单上的"),s("code",[t._v("path")]),t._v("就是目标地址，然后发送数据时候会发送"),s("code",[t._v("cookie")]),t._v("。导致了"),s("code",[t._v("csrf")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("为了预防，"),e("strong",[this._v("加上随机token")]),this._v("，在以下情况下，页面时候服务端返回的，所以"),e("code",[this._v(".html")]),this._v("文件是由模板生成，可以带有服务端随机的生成的随机码。"),e("strong",[this._v("复制一份表单到新的页面并不能够获取到这个随机码，因为每次发送请求都会改变")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("p",[t._v("同时网上说的"),s("code",[t._v("jwt")]),t._v("可以预防，我存有疑惑，因为"),s("code",[t._v("jwt")]),t._v("一般放在"),s("code",[t._v("localstorage")]),t._v("，所以在不考虑"),s("code",[t._v("xss")]),t._v("情况下。这个是可以预防的。")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("strong",[this._v("和xss攻击一起考虑")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("所以我们不能使用"),e("code",[this._v("localstorage")]),this._v("中的"),e("code",[this._v("jwt")]),this._v("，但是可以考虑使用"),e("code",[this._v("sessionstorage")]),this._v("里面的数据。")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"_1-5-数据上传"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-5-数据上传","aria-hidden":"true"}},[this._v("#")]),this._v(" 1.5. 数据上传")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("不同数据上传需要设置不同的"),e("code",[this._v("content-type")]),this._v("。然后在服务进行对应解析。在"),e("code",[this._v("on data")]),this._v("事件中暂存到buffer，然后进一步处理buffer")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ul",[s("li",[t._v("表单 - 一般就是"),s("code",[t._v("name=xx&job=yyy")]),t._v("格式\n"),s("ul",[s("li",[t._v("前端 - application/x-www-form-urlencoded")]),t._v(" "),s("li",[t._v("服务器 - queryString")])])]),t._v(" "),s("li",[t._v("json&xml\n"),s("ul",[s("li",[t._v("前端 - 为application/json")]),t._v(" "),s("li",[t._v("后台 - JSON解析，xml需要转换为json")])])]),t._v(" "),s("li",[t._v("文件\n"),s("ul",[s("li",[t._v("前端 -  multipart/form-data")]),t._v(" "),s("li",[t._v("后台- 通过 formidable")])])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"_1-6-性能"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-6-性能","aria-hidden":"true"}},[this._v("#")]),this._v(" 1.6. 性能")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("文中提到的最佳实践和总结的一样，设置一个永远不会到期的时间，然后通过服务器控制 "),e("strong",[this._v("文件名")]),this._v("来实现客户端更新。")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"_1-6-1-对于数据上传"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-6-1-对于数据上传","aria-hidden":"true"}},[this._v("#")]),this._v(" 1.6.1. 对于数据上传")])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[this._v("限制数据大小")]),this._v(" "),e("li",[this._v("通过"),e("code",[this._v("stream")]),this._v("形式(就是先将数据读取到磁盘中然后处理数据，直接解析数据是在内存中)解析，就像是读取文件那样。")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"_1-7-路由和中间件"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-7-路由和中间件","aria-hidden":"true"}},[this._v("#")]),this._v(" 1.7. 路由和中间件")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("解析的是"),e("code",[this._v("express")]),this._v("框架中，"),e("code",[this._v("use")]),this._v("使用路由，和中间件的解析。")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"_1-8-页面渲染-个人觉得很重要"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-8-页面渲染-个人觉得很重要","aria-hidden":"true"}},[this._v("#")]),this._v(" 1.8. 页面渲染 - 个人觉得很重要")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("这里指的是将服务器发送的数据直接渲染到浏览器。也就是"),e("code",[this._v("SSR")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("因为通过设置"),e("code",[this._v("res.writeHead")]),this._v("可以控制浏览器如何处理"),e("code",[this._v("SSR")]),this._v("。")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("文中提到了"),e("code",[this._v("mime")]),this._v("判断文件类型(可以写到head那种)")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"_1-8-1-下载"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-8-1-下载","aria-hidden":"true"}},[this._v("#")]),this._v(" 1.8.1. 下载")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("code",[this._v('Content-Disposition: attachment; filename="filename.ext"')]),this._v("浏览器弹出窗口下载。")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"_1-9-ssr"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-9-ssr","aria-hidden":"true"}},[this._v("#")]),this._v(" 1.9. SSR")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("通过"),e("code",[this._v("res.end()")]),this._v("发送页面数据。让浏览器渲染。")])}],!1,null,null,null);e.default=i.exports}}]);